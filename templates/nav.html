<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bruno+Ace+SC&family=Comfortaa:wght@350&family=Lexend+Giga:wght@149&family=MonteCarlo&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="../static/img/favicon.ico">
    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>
    <button class = "title montecarlo-regular title" onclick="window.location.pathname='/'">Rekomendacje książek</button>
    <hr class="solid">
    <div class = "nav-container">
        <div class="top-bar">
            <button id = "btn-nav-bar" class = "nav-button">
                <a class="menu">
                    <span class = "line"></span>
                </a>
            </button>
            <input type="text" style="width: 500px; margin-top: 2%; background-color: transparent;" placeholder="Wyszukaj książkę..." id="search-bar">
<!--             <button class="login" style="width: 10vw; margin: 0;margin-top: 2vw;" onclick="searchBook()">Wyszukaj</button> -->
            <input id="search-icon" type="image" onclick="searchBook()" src="../static/img/search_icon.png" style="background-color: transparent; width: 3%; height: 2%; margin-top: 2vw; margin-right: 5vw;" id="search-icon"></button>
            <!-- <input type="image" src="../static/img/Windows_Settings_app_icon.png" style="margin-right: 26%; margin-top: 2%; width: 35px; height: 35px" id="settings-icon"/> -->
             {% if current_user.is_authenticated %}
                <button class="login" style="width: 10vw; margin: 0;margin-top: 2vw;" onclick="window.location.pathname='/profile'">{{current_user.username}}</button>
                <button class="logout" onclick="window.location.pathname='/logout'">Wyloguj się</button>
            {% else %}
                <button class="login" onclick="window.location.pathname='/login'">Zaloguj się</button>
            {% endif %}
        </div>

    </div>
    <hr class="line"/>    
    <h3 class = "subtitle">{% block page_title %}{% endblock %}</h3>
    <hr class="line" style="width: 25%; margin-top: 2vw;"/> 
        <nav id = "nav-bar" class = "sidebar" /*style="visibility: hidden"*/>
            <button class = "sidebar-btn" onclick="location.href='/';" style="margin-top: 100px;">Menu</button><br>
            <button class = "sidebar-btn" onclick="location.href='/recommend';">Rekomendacje</button><br>
            <button class = "sidebar-btn" onclick="location.href='/favorites';">Ulubione</button><br>
            <button class = "sidebar-btn" onclick="location.href='/wishlist';">Lista życzeń</button><br>
        </nav>
    <div class="content">
        {% block content %}{% endblock %}
    </div>
<footer style="margin-top: 1vw;;">
    <hr class="solid2">
    <p>&copy; 2025 Rekomendacje książek</p>
</footer>

{% block scripts %}{% endblock %}
</body>
</html>

<script>
    const navBar = document.querySelector('#nav-bar');
    const toggleButton = document.querySelector('#btn-nav-bar');
    let navVisible = false;

    function toggleNavBar() {
        navVisible = !navVisible;
        navBar.classList.toggle('active', navVisible);
    }

    toggleButton.addEventListener('click', function () {
        toggleNavBar();
        this.classList.toggle('open');
    });

    document.addEventListener('mousemove', (e) => {
        if (e.clientX <= 10 && !navVisible) {
            navVisible = true;
            navBar.classList.add('active');
        } else if (e.clientX > 300 && navVisible && !toggleButton.classList.contains('open')) {
            navVisible = false;
            navBar.classList.remove('active');
        }
    });

    function searchBook() {
        const q = document.getElementById("search-bar").value;
        if (q.trim() !== "") {
            window.location.href = `/main/search?q=${encodeURIComponent(q)}`;
        }
    }

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            searchBook();
        }
    });

    document.getElementById("search-icon").addEventListener('mouseover', (e) =>{
        document.getElementById("search-icon").src = "../static/img/search_icon_hover.png";
    })
    document.getElementById("search-icon").addEventListener('mouseout', (e) =>{
        document.getElementById("search-icon").src = "../static/img/search_icon.png";
    })



    // document.getElementById("settings-icon").addEventListener('click', (e) => {

    //     window.location.pathname="profile";
    //     console.debug(window.location.pathname);
    // })

</script>